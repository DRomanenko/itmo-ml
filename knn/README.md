# Непараметрическая регрессия
### Цели работы:
1. практика первичных навыков обработки данных: нормализация, Ohe-Hot преобразование;
2. сведение задачи классификации к задаче непараметрической регрессии;
3. реализация решения задачи непараметрической регрессии ядерным сглаживанием Надарая Ватсона;
4. практика наивного способа настройки и анализа гиперпараметров модели, решающей задачу непараметрической регрессии.
### Набор данных
Выберите любой понравившийся набор данных для задачи классификации из следующего списка:
1. [**car**](https://www.openml.org/d/40975)
2. [vehicle](https://www.openml.org/d/54)
3. [wine](https://www.openml.org/d/187)
4. [bridges](https://www.openml.org/d/327)
### Сведение к задаче регрессии и обработка данных
Перейдите от задачи классификации к задаче регрессии, используя [OneHot преобразование](https://ru.wikipedia.org/wiki/%D0%A3%D0%BD%D0%B8%D1%82%D0%B0%D1%80%D0%BD%D1%8B%D0%B9_%D0%BA%D0%BE%D0%B4). Вместо одного целевого признака в выбранный набор данных добавляется столько новых числовых переменных, сколько в нём содержится классов. Помимо этого, если выбранный Вами набор данных содержит нечисловые признаки, эти признаки необходимо векторизовать (перейти от категорий к числам), заполнить пропуски (если есть) и нормализовать. В наборе данных bridges также необходимо избавиться от столбца IDENTIF, поскольку он является идентификатором записи.
### Реализация алгоритма и настройка гиперпараметров, анализ результатов
Реализуйте алгоритм решения задачи непареметрической регрессии при помощи ядерного сглаживания Надарая-Ватсона.
Найдите лучшую комбинацию гиперпараметров алгоритма непараметрической регрессии:
* функция расстояния:
    * расстояние Евклида,
    * расстояние Манхэттена, 
    * расстояние Чебышева; 
* функция ядра
    * uniform: ![K(u)=\frac{1}{2}](https://latex.codecogs.com/svg.latex?K(u)=\frac{1}{2})
    * triangular: ![K(u)=(1 - |u|)](https://latex.codecogs.com/svg.latex?K(u)=(1%20-%20|u|))
    * epanechnikov: ![K(u)=\frac{3}{4}(1 - u^2)](https://latex.codecogs.com/svg.latex?K(u)=\frac{3}{4}(1%20-%20u^2))
    * quartic: ![K(u)=\frac{15}{16}(1 - u^2)^2](https://latex.codecogs.com/svg.latex?K(u)=\frac{15}{16}(1%20-%20u^2)^2)
* тип окна (окно, зависящее от количества соседей или фиксированное)
* параметры окна:
    * *количество ближайших соседей* от ![1](https://latex.codecogs.com/svg.latex?1) до ![\sqrt{|D|}](https://latex.codecogs.com/svg.latex?\sqrt{|D|}), ![|D|](https://latex.codecogs.com/svg.latex?|D|) - размер набора данных, ![\sqrt{|D|}](https://latex.codecogs.com/svg.latex?\sqrt{|D|}) является эвристикой на число ближайших соседей для метрических алгоритмов.
    
    **ИЛИ**
    
    * *размер окна*, его необходимо выбирать исходя из “размеров” набора данных; хорошей практикой является настройка ширины окна на отрезке ![\left[\frac{R(D)}{\sqrt{|D|}};R(D)\right]](https://latex.codecogs.com/svg.latex?\left[\frac{R(D)}{\sqrt{|D|}};R(D)\right]) до  с шагом ![\frac{R(D)}{\sqrt{|D|}}](https://latex.codecogs.com/svg.latex?\frac{R(D)}{\sqrt{|D|}}), где ![R(D](https://latex.codecogs.com/svg.latex?R(D)) - самое большое расстояние  между элементами в наборе данных.

Таким образом требуется перебрать ![24\sqrt{|D|}](https://latex.codecogs.com/svg.latex?24\sqrt{|D|}) комбинаций гиперпараметров и *найти лучшую*.

Используйте [Leave-One-Out](https://neerc.ifmo.ru/wiki/index.php?title=%D0%9C%D0%B5%D1%82%D1%80%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D1%80_%D0%B8_%D0%BC%D0%B5%D1%82%D0%BE%D0%B4_%D0%B1%D0%BB%D0%B8%D0%B6%D0%B0%D0%B9%D1%88%D0%B8%D1%85_%D1%81%D0%BE%D1%81%D0%B5%D0%B4%D0%B5%D0%B9#.D0.9C.D0.B5.D1.82.D0.BE.D0.B4_.D0.BF.D0.B0.D1.80.D0.B7.D0.B5.D0.BD.D0.BE.D0.B2.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D0.BE.D0.BA.D0.BD.D0.B0) перекрёстную проверку для настройки алгоритма.

Критерием качества является [F-мера](http://bazhenov.me/blog/2012/07/21/classification-performance-evaluation.html). Для её подсчёта этого потребуется определить максимальную компоненту результирующего вектора целевых признаков, полученных из One-Hot преобразования, после применения очередной конфигурации алгоритма непараметрической регрессии (алгоритм с одной из комбинаций гиперпараметров).

Для лучшей найденной комбинации гиперпараметров постройте графики зависимости F-меры от числа *ближайших соседей* **ИЛИ** *ширины окна* (при фиксированных лучших значениях прочих гиперпараметров). 
### Схема работы:
![](/knn/resources/scheme.png)
